package rsi

import (
	"testing"
)

func TestCalculateUpwardDownward(t *testing.T) {
	data := []float32{
		256.60,
		264.61,
		259.46,
		274.45,
		260.54,
		255.90,
		256.79,
		258.71,
		249.83,
		244.40,
		234.86,
		224.57,
		221.31,
		217.61,
		213.97,
		207.52,
		203.93,
		201.16,
		193.17,
		184.47,
		182.90,
		185.77,
		188.87,
		180.14,
		176.89,
		173.86,
		166.52,
		166.35,
		167.98,
		172.08,
		168.54,
		169.15,
		171.79,
		170.06,
		161.2,
		160.61,
		160.31,
		161.83,
		164.31,
		160.19,
		153.75,
		160.67,
		162.55,
		165.08,
		162.99,
		180.59,
		184.31,
		187.04,
		185,
		185.9,
		180.54,
		186.79,
		184.51,
		185.06,
		185.52,
		192.58,
		194.77,
		207.46,
		195.28,
		193.88,
		189.19,
		191.81,
		190.41,
		192.22,
		191.15,
		197.58,
		183.25,
		180.13,
		184.13,
		180.45,
		183.26,
		174.48,
		173.44,
		172.92,
		182,
		187.71,
		193.81,
		197.79,
		190.9,
		202.77,
		205.71,
		207.63,
		196.88,
		202.07,
		200.86,
		197.37,
		208.31,
		202.04,
		214.24,
		209.25,
		194.64,
		196.89,
		207.32,
		201.29,
		196.81,
		194.76,
		189.98,
		188.27,
		181.41,
		173.22,
		166.66,
		177.9,
		160.27,
		144.43,
		143.89,
		143.75,
		133.42,
		127.17,
		128.78,
		131.49,
		122.4,
		123.56,
		123.22,
		118.85,
		119.77,
		113.06,
		110.34}

	for i, j := 0, len(data)-1; i < j; i, j = i+1, j-1 {
		data[i], data[j] = data[j], data[i]
	}

	calculator := NewRSICalculator(data)
	calculator.Load()

	if calculator.Sheet.records[0].rawData != data[0] {
		t.Fatal("Fail0")
	}
	if calculator.Sheet.records[1].rawData != data[1] {
		t.Fatal("Fail1")
	}
	if calculator.Sheet.records[0].upward != 0 {
		t.Fatal("Fail1")
	}
	if calculator.Sheet.records[0].downward != 0 {
		t.Fatal("Fail1")
	}

	for _, value := range calculator.Sheet.records {
		println(value.rsi)
	}
}
